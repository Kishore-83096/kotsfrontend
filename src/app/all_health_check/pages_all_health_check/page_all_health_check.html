<article class="health-page-card">
  <header class="page-header">
    <h2>All APIs Health</h2>
    <p>Flask API base URL: <code>{{ apiBaseUrl() }}</code></p>
    <button type="button" (click)="runAllHealthChecks()" [disabled]="isChecking()">
      {{ isChecking() ? 'Checking...' : 'Run All Health Checks' }}
    </button>
    @if (checkedAt()) {
      <p class="checked-at">Last checked: {{ checkedAt() }}</p>
    }
    @if (pageError()) {
      <p class="error">{{ pageError() }}</p>
    }
  </header>

  @if (isChecking()) {
    <section class="health-list">
      @for (item of [1, 2, 3]; track item) {
        <section class="health-details">
          <div class="skeleton-block skeleton-line lg"></div>
          <div class="skeleton-block skeleton-line"></div>
          <div class="skeleton-block skeleton-line"></div>
        </section>
      }
    </section>
  }

  <section class="health-list">
    @for (result of healthResults(); track result.module) {
      <section class="health-details" [class.healthy]="result.isHealthy" [class.unhealthy]="!result.isHealthy">
        <p><strong>Module:</strong> {{ result.module }}</p>
        <p><strong>Endpoint:</strong> <code>{{ result.endpoint }}</code></p>
        <p><strong>HTTP Status:</strong> {{ result.httpStatus ?? 'N/A' }}</p>
        <p><strong>Success:</strong> {{ result.isHealthy }}</p>
        <p><strong>Message:</strong> {{ result.message }}</p>
        <p><strong>Service:</strong> {{ result.payload?.data?.service ?? 'N/A' }}</p>
        <p><strong>Payload Size:</strong> {{ result.payload?.size ?? 'N/A' }}</p>
      </section>
    }
  </section>
</article>
